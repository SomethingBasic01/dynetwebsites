-- download_and_run.lua: Script to download and run a program

-- Get the current working directory
local currentDir = shell.dir()

-- Function to download the program
local function downloadProgram(url, filename)
    print("Downloading " .. filename .. " from " .. url)
    local result = shell.run("wget " .. url .. " " .. filename)
    return result
end

-- Function to run the program in a new shell tab
local function runProgram(filepath)
    print("Running " .. filepath .. " in a new shell tab")
    if multishell then
        multishell.launch({}, "shell", "run", filepath)
    else
        print("Multishell not supported; running in the same shell")
        shell.run(filepath)
    end
end

-- Main Execution
local url = "https://github.com/LDDestroier/enchat/raw/master/enchat3.lua"
local filename = "enchat3.lua"
local filepath = fs.combine(currentDir, filename)  -- Get the absolute path to the file

if downloadProgram(url, filename) then
    runProgram(filepath)  -- Use the absolute path to run the program
else
    print("Failed to download the program.")
end
