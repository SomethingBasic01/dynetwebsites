-- Trivia game data
local triviaQuestions = {
    { question = "The Minecraft world is infinite. True or False?", answer = "False" },
    { question = "Creepers were originally a coding bug. True or False?", answer = "True" },
    { question = "Diamonds can be mined with a wooden pickaxe. True or False?", answer = "False" },
}
local currentQuestionIndex = 1
local triviaFeedback = "" -- Feedback message for the user

-- Function to trim whitespace from input
local function trim(s)
    return (s:gsub("^%s*(.-)%s*$", "%1"))
end

function getDynamicLine(name, page)
    if name == "triviaQuestion" then
        return triviaQuestions[currentQuestionIndex].question
    elseif name == "triviaFeedback" then
        return triviaFeedback
    end
    return ""  -- Ensure no unintended output
end

function takeDynamicInput(client, input)
    -- Assume input is formatted as "cookie:response"
    local cookie, response = split(input, ":")

    -- Debug: Print received input and cookie
    print("Received input with cookie: '" .. cookie .. "' and response: '" .. response .. "' from client " .. tostring(client))

    -- Check that the cookie matches our expected question
    if cookie == "Type" then
        response = trim(response):lower()  -- Clean the response input

        if response == "true" or response == "false" then
            local correctAnswer = triviaQuestions[currentQuestionIndex].answer:lower()
            if response == correctAnswer then
                triviaFeedback = "^f5RIGHT"
            else
                triviaFeedback = "^fEWRONG"
            end
            -- Move to the next question
            currentQuestionIndex = (currentQuestionIndex % #triviaQuestions) + 1
        else
            triviaFeedback = "^fEInvalid input! Please type 'True' or 'False'."
        end
    else
        print("Unexpected cookie or input format!")
    end
end
